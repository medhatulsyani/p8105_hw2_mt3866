---
title: "p8105_hw2_mt3866"
output: github_document
---

## Problem 1

First, load the tidyverse library

```{r}
library(tidyverse)
```

Importing the data sets we are using

```{r}
pols_df =
  read_csv("fivethirtyeight_datasets/pols-month.csv")

unemployment_df =
  read_csv("fivethirtyeight_datasets/unemployment.csv")

snp_df =
  read_csv("fivethirtyeight_datasets/snp.csv")

```

Clean names in pols-months data set, separate into year month and day, make year and day integers while month is a character word. Now, remove prez_dem prez_gop and the day variable, and make a president variable taking values gop and dem.

```{r}
pols_df=
    read_csv("fivethirtyeight_datasets/pols-month.csv") |>
    janitor::clean_names() |>
    separate(mon, into = c("year", "month", "day"), sep = "-") |>
    mutate(
      year = as.integer(year),
      month = as.integer(month),
      day = as.integer(day),
      month = month.name[month]
    ) |>
  mutate(president = prez_dem + prez_gop
         ) |>
mutate(month = substr(month, 1, 3))
  pols_df = select(pols_df, -day, -prez_dem, -prez_gop)

```

Clean the data in snp.csv using a similar process to the above. Arrange according to year and month, and organize so that year and month are the leading columns.

```{r}
snp_df=
    read_csv("fivethirtyeight_datasets/snp.csv") |>
    janitor::clean_names() |>
    separate(date, into = c("month", "day", "year"), sep = "/") |>
    select(-day) |>
    mutate(
      year = as.integer(year),
      month = as.integer(month),
      month = month.name[month]
    ) |>
  select(year, month, everything())|>
  mutate(month = substr(month, 1, 3))

```

Tidy the unemployment data so that it can be merged with the previous datasets.
```{r}
library(haven)
unemployment_df=
  read_csv("fivethirtyeight_datasets/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    cols = jan:dec,
    names_to = "month"
  )

```

Join the datasets by merging snp into pols

```{r}
pols_df=
  left_join(pols_df, snp_df, by = c("year", "month"))
```

Merge unemployment into the result

```{r}
pols_df=
  left_join(pols_df, unemployment_df, by = c("year", "month"))
```

## Problem 2

Specify the sheet in the Excel file and to omit non-data entries using arguments in read_excel, use reasonable variable names, omit rows that do not include dumpster-specific data, round the number of sports balls to the nearest integer and converts the result to an integer variable (using as.integer)

```{r}
library(readxl)
trash_df =
  read_excel("dataset2/trash_wheel.xlsx",
             skip = 1,
             sheet = "Mr. Trash Wheel",
             na = c(".", "NA", "")
  )

trash_df=
  drop_na(trash_df, Dumpster)|>
  janitor::clean_names()|>
  mutate(sports_balls = as.integer(round(sports_balls)))

```

Use a similar process for professor trash wheel and gwynnda

```{r}
library(readxl)
secondtrash_df =
  read_excel("dataset2/trash_wheel.xlsx",
             skip = 1,
             sheet = "Professor Trash Wheel",
             na = c(".", "NA", "")
  )

secondtrash_df=
  drop_na(secondtrash_df, Dumpster)|>
  janitor::clean_names()

library(readxl)
thirdtrash_df =
  read_excel("dataset2/trash_wheel.xlsx",
             skip = 1,
             sheet = "Gwynnda Trash Wheel",
             na = c(".", "NA", "")
  )

thirdtrash_df=
  drop_na(thirdtrash_df, Dumpster)|>
  janitor::clean_names()
```

Bind rows (combine data)

```{r}
trash_df= 
    read_excel("dataset2/trash_wheel.xlsx") |>
  mutate(newdumpster="Mr_Trash_Wheel")
  
secondtrash_df=
  read_excel("dataset2/trash_wheel.xlsx") |>
    mutate(newdumpster="Professor_Trash_Wheel")
  
thirdtrash_df=
  read_excel("dataset2/trash_wheel.xlsx") |>
    mutate(newdumpster="Gwynnda_Trash_Wheel")

trash_tidy=
    bind_rows(trash_df, secondtrash_df, thirdtrash_df) |>
    janitor::clean_names()

```

## Problem 3

Import, clean, and tidy data sets

```{r}
zillow_df =
  read_csv("zillow_data/Zip_Codes.csv")|>
    janitor::clean_names()

nyczillow_df =
  read_csv("zillow_data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv") |>
  janitor::clean_names() |>
    pivot_longer(
    cols = x2015_01_31:x2024_08_31,
    names_to = "file_date",
    values_to = "zillow")|>
    rename(county = county_name)
```

merge datasets
```{r}
zillow_df=
  left_join(zillow_df, nyczillow_df, by = ("county"))
```

